{% extends 'base.html' %}
{% load static %}
{% block title %}Calendrier 15 minutes - 2 box{% endblock %}

{% block content %}
<div class="calendar-container">
    <div class="calendar-box">
        <h2>Choisir un sous-créneau de 15 minutes</h2>
        <p>Date : {{ date_chosen }}</p>
        <p>Heure de base : {{ hour_chosen }}</p>

        <div class="tables-container">
            <!-- Tableau pour le Box 1 -->
            <table>
                <thead>
                    <tr>
                        <th colspan="2">Box 1</th>
                    </tr>
                    <tr>
                        <th>Créneau</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                {% for cr in sub_creneaux %}
                    <tr>
                        <td>{{ cr.heure_debut|time:"H:i" }} - {{ cr.heure_fin|time:"H:i" }}</td>
                        <td>
                            {% if cr.reserved_for_box1 %}
                                <!-- Créneau réservé => rouge, non cliquable -->
                                <span class="time-slot reserved">Réservé</span>
                            {% else %}
                                <!-- Lien ou bouton pour réserver ce créneau sur box 1 -->
                                <form method="POST" action="">
                                    {% csrf_token %}
                                    <input type="hidden" name="creneau_id" value="{{ cr.id }}">
                                    <input type="hidden" name="box_id" value="1">
                                    <button type="submit">Réserver</button>
                                </form>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>

            <!-- Tableau pour le Box 2 -->
            <table>
                <thead>
                    <tr>
                        <th colspan="2">Box 2</th>
                    </tr>
                    <tr>
                        <th>Créneau</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                {% for cr in sub_creneaux %}
                    <tr>
                        <td>{{ cr.heure_debut|time:"H:i" }} - {{ cr.heure_fin|time:"H:i" }}</td>
                        <td>
                            {% if cr.reserved_for_box2 %}
                                <span class="time-slot reserved">Réservé</span>
                            {% else %}
                                <form method="POST" action="">
                                    {% csrf_token %}
                                    <input type="hidden" name="creneau_id" value="{{ cr.id }}">
                                    <input type="hidden" name="box_id" value="2">
                                    <button type="submit">Réserver</button>
                                </form>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}